(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[878],{9915:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/overlay",function(){return t(8864)}])},8864:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return f}});var o=t(5893),a=t(7294);let l="14.20.1";class i{static getChampionIconUrl(e){let{championName:n,championId:t,version:o=l,fallbackToProfileIcon:a=!0,profileIconId:i}=e,r=[];return n&&(r.push("https://ddragon.leagueoflegends.com/cdn/".concat(o,"/img/champion/").concat(n,".png")),o!==l&&r.push("https://ddragon.leagueoflegends.com/cdn/".concat(l,"/img/champion/").concat(n,".png")),r.push("https://ddragon.leagueoflegends.com/cdn/img/champion/loading/".concat(n,"_0.jpg")),r.push("https://ddragon.leagueoflegends.com/cdn/img/champion/splash/".concat(n,"_0.jpg"))),t&&!n&&r.push("https://ddragon.leagueoflegends.com/cdn/".concat(o,"/img/champion/loading/Champion").concat(t,"_0.jpg")),a&&i&&(r.push("https://ddragon.leagueoflegends.com/cdn/".concat(o,"/img/profileicon/").concat(i,".png")),o!==l&&r.push("https://ddragon.leagueoflegends.com/cdn/".concat(l,"/img/profileicon/").concat(i,".png"))),r.push("https://ddragon.leagueoflegends.com/cdn/".concat(o,"/img/profileicon/29.png")),r.filter(e=>!this.failedUrls.has(e))}static async loadChampionIcon(e){let n=JSON.stringify(e);if(this.cache.has(n))return this.cache.get(n);for(let t of this.getChampionIconUrl(e))try{if(await this.testImageUrl(t))return this.cache.set(n,t),t;this.failedUrls.add(t)}catch(e){this.failedUrls.add(t);continue}return null}static testImageUrl(e){return new Promise(n=>{let t=new Image;t.onload=()=>n(!0),t.onerror=()=>n(!1),t.src=e,setTimeout(()=>n(!1),3e3)})}static async preloadChampionIcons(e){let n=e.map(async e=>{(e.championName||e.championId)&&await this.loadChampionIcon({championName:e.championName,championId:e.championId,profileIconId:e.profileIconId})});await Promise.allSettled(n)}static clearCache(){this.cache.clear(),this.failedUrls.clear()}static getCacheStats(){return{cacheSize:this.cache.size,failedUrlsCount:this.failedUrls.size}}}function r(e){let{role:n,className:t}=e,a=(n||"").toLowerCase(),l={top:"\uD83D\uDEE1️",jungle:"\uD83C\uDF3F",mid:"\uD83D\uDDE1️",adc:"\uD83C\uDFF9",bottom:"\uD83C\uDFF9",support:"✨"}[a]||"\uD83C\uDFA7";return(0,o.jsx)("span",{className:t,"aria-label":a||"unknown",title:a||"unknown",children:l})}function c(e){let{alt:n,className:t="w-full h-full object-cover",role:l,showLoadingSpinner:c=!1,...s}=e,[d,u]=(0,a.useState)(null),[m,p]=(0,a.useState)(!0),[h,g]=(0,a.useState)(!1);return((0,a.useEffect)(()=>{let e=!1,n=async()=>{p(!0),g(!1);try{let n=await i.loadChampionIcon(s);e||(n?u(n):g(!0))}catch(n){e||g(!0)}finally{e||p(!1)}};return s.championName||s.championId||s.profileIconId?n():(p(!1),g(!0)),()=>{e=!0}},[JSON.stringify(s)]),m&&c)?(0,o.jsx)("div",{className:"".concat(t," flex items-center justify-center bg-neutral-800"),children:(0,o.jsx)("div",{className:"w-4 h-4 border-2 border-violet-500 border-t-transparent rounded-full animate-spin"})}):d&&!h?(0,o.jsx)("img",{src:d,alt:n,className:t,onError:()=>g(!0)}):(0,o.jsx)(r,{role:l,className:t})}i.cache=new Map,i.failedUrls=new Set;var s=t(3935);function d(e){let{items:n,x:t,y:l,onClose:i,visible:r}=e,c=(0,a.useRef)(null),[d,u]=(0,a.useState)({x:t,y:l});if((0,a.useEffect)(()=>{if(!r||!c.current)return;let e=c.current.getBoundingClientRect(),n=window.innerWidth,o=window.innerHeight,a=t,i=l;t+e.width>n&&(a=n-e.width-8),l+e.height>o&&(i=o-e.height-8),i<8&&(i=8),a<8&&(a=8),u({x:a,y:i})},[r,t,l]),(0,a.useEffect)(()=>{if(!r)return;let e=e=>{c.current&&!c.current.contains(e.target)&&i()},n=e=>{"Escape"===e.key&&i()};return document.addEventListener("mousedown",e),document.addEventListener("keydown",n),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("keydown",n)}},[r,i]),!r)return null;let m=(0,o.jsx)("div",{ref:c,className:"fixed z-50 bg-neutral-900/95 backdrop-blur-md border border-neutral-700/50 rounded-lg shadow-xl py-2 min-w-[180px] animate-in fade-in-0 zoom-in-95 duration-100",style:{left:d.x,top:d.y},children:n.map((e,n)=>{if(e.separator)return(0,o.jsx)("div",{className:"my-1 border-t border-neutral-700/50"},"separator-".concat(n));let t=e.icon;return(0,o.jsxs)("button",{onClick:()=>{e.disabled||(e.onClick(),i())},disabled:e.disabled,className:"\n              w-full px-3 py-2 text-left text-sm flex items-center gap-3 transition-colors\n              ".concat(e.disabled?"text-neutral-500 cursor-not-allowed":e.danger?"text-red-400 hover:bg-red-500/10 hover:text-red-300":"text-neutral-200 hover:bg-white/10 hover:text-white","\n            "),children:[t&&(0,o.jsx)(t,{className:"w-4 h-4 flex-shrink-0"}),(0,o.jsx)("span",{className:"truncate",children:e.label})]},e.id)})});return"undefined"!=typeof document?(0,s.createPortal)(m,document.body):null}var u=t(5050),m=t(6675);let p={default:{id:"default",name:"Default",description:"Standard dark theme with violet accents",colors:{background:"bg-neutral-900/30",border:"ring-white/10",text:"text-white",accent:"ring-violet-500/50",speaking:"ring-green-400",hover:"hover:bg-white/10"},opacity:{base:.4,hover:1},effects:{blur:"backdrop-blur-[4px]",shadow:"shadow-lg shadow-green-400/25",scale:1.05}},minimal:{id:"minimal",name:"Minimal",description:"Clean and minimal with reduced visual noise",colors:{background:"bg-black/20",border:"ring-white/5",text:"text-white",accent:"ring-blue-400/40",speaking:"ring-green-300",hover:"hover:bg-white/5"},opacity:{base:.6,hover:.9},effects:{blur:"backdrop-blur-[2px]",shadow:"shadow-md shadow-green-300/20",scale:1.02}},gaming:{id:"gaming",name:"Gaming",description:"High contrast theme optimized for gaming",colors:{background:"bg-red-900/40",border:"ring-red-400/20",text:"text-white",accent:"ring-red-400/60",speaking:"ring-yellow-400",hover:"hover:bg-red-400/20"},opacity:{base:.5,hover:1},effects:{blur:"backdrop-blur-[6px]",shadow:"shadow-lg shadow-yellow-400/30",scale:1.08}},professional:{id:"professional",name:"Professional",description:"Clean corporate theme with blue accents",colors:{background:"bg-slate-800/35",border:"ring-slate-400/15",text:"text-slate-100",accent:"ring-blue-400/50",speaking:"ring-emerald-400",hover:"hover:bg-slate-400/15"},opacity:{base:.45,hover:.95},effects:{blur:"backdrop-blur-[3px]",shadow:"shadow-lg shadow-emerald-400/25",scale:1.03}},neon:{id:"neon",name:"Neon",description:"Cyberpunk-inspired theme with neon colors",colors:{background:"bg-purple-900/30",border:"ring-cyan-400/20",text:"text-cyan-100",accent:"ring-cyan-400/70",speaking:"ring-pink-400",hover:"hover:bg-cyan-400/10"},opacity:{base:.3,hover:1},effects:{blur:"backdrop-blur-[8px]",shadow:"shadow-xl shadow-pink-400/40",scale:1.1}}},h={WebkitAppRegion:"drag"},g={WebkitAppRegion:"no-drag"};function f(){let[e,n]=(0,a.useState)([]),[t,l]=(0,a.useState)(!0),[i,r]=(0,a.useState)("default"),[s,f]=(0,a.useState)("Unknown"),v=(0,a.useRef)(null),b=(0,a.useRef)({}),{speakingUsers:w,isSelfSpeaking:y,setUserVolume:x,getUserVolume:k,connected:I,connectedPeers:C}=(0,m.M)(),{contextMenu:N,showContextMenu:j,hideContextMenu:S}=function(){let[e,n]=(0,a.useState)({visible:!1,x:0,y:0,items:[]});return{contextMenu:e,showContextMenu:(e,t)=>{e.preventDefault(),e.stopPropagation(),n({visible:!0,x:e.clientX,y:e.clientY,items:t})},hideContextMenu:()=>{n(e=>({...e,visible:!1}))}}}(),E=p[i]||p.default;(0,a.useEffect)(()=>{r(function(){try{return localStorage.getItem("hexcall-overlay-theme")||"default"}catch(e){console.warn("Failed to load overlay theme:",e)}return"default"}())},[]);let[U,_]=(0,a.useState)([]);(0,a.useEffect)(()=>{let e=e=>{Array.isArray(null==e?void 0:e.detail)&&_(e.detail)};window.addEventListener("hexcall:presence",e);try{let e=localStorage.getItem("hexcall-presence");e&&_(JSON.parse(e))}catch(e){}return()=>{window.removeEventListener("hexcall:presence",e)}},[]),(0,a.useEffect)(()=>{var e,t;let o=null===(t=window.hexcall)||void 0===t?void 0:null===(e=t.onLcuUpdate)||void 0===e?void 0:e.call(t,e=>{var t,o,a,l,i,r,c,s,d,u;(null==e?void 0:e.phase)&&v.current&&(v.current.dataset.phase=String(e.phase));let m=(null==e?void 0:e.members)||[],p=(null==e?void 0:null===(o=e.session)||void 0===o?void 0:null===(t=o.gameData)||void 0===t?void 0:t.playerChampionSelections)||[],h=(null==e?void 0:e.phase)||"";f(h);let g=(null==e?void 0:null===(i=e.session)||void 0===i?void 0:null===(l=i.gameData)||void 0===l?void 0:null===(a=l.gameDeltas)||void 0===a?void 0:a.clientVersion)||(null==e?void 0:null===(c=e.session)||void 0===c?void 0:null===(r=c.gameData)||void 0===r?void 0:r.gameVersion)||"14.20.1";"InProgress"===h&&0===Object.keys(b.current).length&&fetch("https://ddragon.leagueoflegends.com/cdn/".concat(g,"/data/en_US/champion.json")).then(e=>e.json()).then(e=>{let n={};for(let o of Object.keys(e.data||{})){var t;let a=null===(t=e.data[o])||void 0===t?void 0:t.key;a&&(n[String(a)]=o)}b.current=n}).catch(()=>{});let w={},y=["InProgress","EndOfGame"].includes(h);for(let e of m){let n=e.puuid||e.summonerId||e.accountId||String(Math.random()),t=(e.assignedPosition||e.position||"").toLowerCase(),o="bottom"===t?"adc":t,a=e.summonerName||e.gameName||"Player";w[n]={puuid:n,name:a,role:o,summonerId:e.summonerId,accountId:e.accountId,profileIconId:e.profileIconId,iconUrl:!y&&e.profileIconId?"https://ddragon.leagueoflegends.com/cdn/".concat(g,"/img/profileicon/").concat(e.profileIconId,".png"):void 0,volume:1,displayType:y?"champion":"summoner",displayName:a}}for(let e of p){let n=(null==e?void 0:e.puuid)||(null==e?void 0:e.summonerId)||(null==e?void 0:e.accountId);if(!n)continue;let t=((null==e?void 0:e.assignedPosition)||(null==e?void 0:e.position)||"").toLowerCase(),o="bottom"===t?"adc":t;if(w[n]&&(w[n].role=o,w[n].championName=null==e?void 0:e.championName,w[n].championId=null==e?void 0:e.championId,y)){let t=(null==e?void 0:e.championName)||(null==e?void 0:e.championId);if(t){let e="string"==typeof t?t:void 0;if(!e){let n=b.current[String(t)]||"";n&&(e=n)}e&&(w[n].iconUrl="https://ddragon.leagueoflegends.com/cdn/".concat(g,"/img/champion/").concat(e,".png"),w[n].displayName=e)}}}let x=Object.values(w);try{let n=localStorage.getItem("hexcall-presence"),t=n?JSON.parse(n):U,o=(null==e?void 0:null===(s=e.self)||void 0===s?void 0:s.puuid)||(null==e?void 0:null===(d=e.self)||void 0===d?void 0:d.summonerId)||(null==e?void 0:null===(u=e.self)||void 0===u?void 0:u.accountId);t&&t.length?x=x.filter(e=>t.includes(e.puuid||"")||t.includes(e.name||"")||o&&e.puuid===o):o&&(x=x.filter(e=>e.puuid===o))}catch(e){}n(x)});return()=>{o&&o()}},[]);let D=(0,a.useMemo)(()=>C?C.map(e=>({puuid:e.id,name:e.name||e.id.slice(0,8),displayName:e.name||e.id.slice(0,8),iconUrl:e.iconUrl,displayType:"summoner",speaking:e.isSelf?y:null==w?void 0:w.has(e.id),volume:1,role:"unknown",championName:void 0,championId:void 0,profileIconId:void 0})):[],[C,y,w]),P=e.length>0?e:D;P.length;let O=(0,a.useMemo)(()=>{let e=["top","jungle","mid","adc","support","bottom"];return P.map(e=>({...e,speaking:e.speaking||(null==w?void 0:w.has(e.puuid||""))||(null==w?void 0:w.has(e.name||""))||!1,normalizedRole:"bottom"===e.role?"adc":e.role})).sort((n,t)=>{let o=e.indexOf(n.normalizedRole||""),a=e.indexOf(t.normalizedRole||"");return -1!==o&&-1!==a?o-a:-1!==o?-1:-1!==a?1:(n.name||"").localeCompare(t.name||"")})},[P,w]);return t?I||"InProgress"===s?(0,o.jsxs)("div",{ref:v,className:"rounded-2xl select-none transition-all duration-300 ease-in-out inline-flex p-1 ".concat(E.colors.background," ").concat(E.effects.blur),style:{...h,opacity:E.opacity.base,"--hover-opacity":E.opacity.hover,"--hover-scale":E.effects.scale},onMouseEnter:e=>{e.currentTarget.style.opacity=E.opacity.hover.toString(),e.currentTarget.style.transform="scale(".concat(E.effects.scale,")")},onMouseLeave:e=>{e.currentTarget.style.opacity=E.opacity.base.toString(),e.currentTarget.style.transform="scale(1)"},onContextMenu:e=>{let n=Object.values(p).map(e=>({id:"theme-".concat(e.id),label:e.name,onClick:()=>{r(e.id),function(e){try{localStorage.setItem("hexcall-overlay-theme",e)}catch(e){console.warn("Failed to save overlay theme:",e)}}(e.id)}}));j(e,[{id:"hide",label:"Hide Overlay",icon:u.tgn,onClick:()=>l(!1)},{id:"settings",label:"Open Settings",icon:u.mdD,onClick:()=>{window.open("/settings","_blank")}},{separator:!0,id:"sep1",label:"",onClick:()=>{}},{id:"themes",label:"Themes",icon:u.SaA,onClick:()=>{}},...n,{separator:!0,id:"sep2",label:"",onClick:()=>{}},{id:"join",label:"Join Call",icon:u.I7T,onClick:()=>{var e,n;return null===(e=(n=window).__hexcall_join)||void 0===e?void 0:e.call(n)}},{id:"leave",label:"Leave Call",icon:u.tNS,onClick:()=>{var e,n;return null===(e=(n=window).__hexcall_leave)||void 0===e?void 0:e.call(n)},danger:!0}])},children:[(0,o.jsx)("div",{className:"flex flex-col gap-1 items-center",children:O.map(e=>{let n=e.role||"unknown";return(0,o.jsxs)("div",{className:"group relative flex flex-col items-center",style:g,onContextMenu:n=>{j(n,[{id:"mute",label:"Mute User",icon:u.WjQ,onClick:()=>null==x?void 0:x(e.puuid||e.name||"",0)},{id:"volume-50",label:"Set Volume 50%",onClick:()=>null==x?void 0:x(e.puuid||e.name||"",.5)},{id:"volume-100",label:"Set Volume 100%",onClick:()=>null==x?void 0:x(e.puuid||e.name||"",1)},{separator:!0,id:"sep1",label:"",onClick:()=>{}},{id:"ping",label:"Ping User",icon:u.GPV,onClick:()=>console.log("Ping user:",e.name)}])},children:["unknown"!==n&&(0,o.jsx)("div",{className:"absolute -top-1 -left-1 w-2 h-2 ".concat({top:"bg-blue-400",jungle:"bg-green-400",mid:"bg-yellow-400",adc:"bg-red-400",support:"bg-purple-400"}[n]||"bg-neutral-400"," rounded-full border border-neutral-900 z-10")}),(0,o.jsx)("div",{className:"w-9 h-9 rounded-full bg-neutral-900/40 overflow-hidden flex items-center justify-center ring-1 transition-all cursor-pointer ".concat(e.speaking?"ring-2 ".concat(E.colors.speaking," ").concat(E.effects.shadow," animate-pulse"):"".concat(E.colors.border," group-hover:").concat(E.colors.accent)),children:e.iconUrl?(0,o.jsx)("img",{src:e.iconUrl,alt:e.displayName||e.name||"Player",className:"w-full h-full object-cover",onError:n=>{let t=n.target;t.style.display="none";let o=t.parentElement;if(o){let n=document.createElement("div");n.innerHTML='<div class="w-8 h-8 rounded-full bg-neutral-700 flex items-center justify-center"><span class="text-xs text-neutral-300">'.concat((e.displayName||e.name||"P")[0].toUpperCase(),"</span></div>"),o.appendChild(n)}}}):(0,o.jsx)(c,{championName:e.championName,championId:e.championId,profileIconId:e.profileIconId,alt:e.displayName||e.name||"Player",role:e.role,className:"w-full h-full object-cover"})}),e.speaking&&(0,o.jsx)("div",{className:"absolute -top-0.5 -right-0.5 w-3 h-3 bg-green-400 rounded-full border-2 border-neutral-900 animate-pulse"})]},e.puuid)})}),(0,o.jsx)(d,{visible:N.visible,x:N.x,y:N.y,items:N.items,onClose:S})]}):null:(0,o.jsx)("div",{className:"fixed top-2 right-2 w-8 h-8 bg-neutral-900/50 rounded-full flex items-center justify-center cursor-pointer hover:bg-neutral-800/70 transition-colors",onClick:()=>l(!0),style:g,children:(0,o.jsx)(u.dSq,{className:"w-4 h-4 text-neutral-400"})})}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=9915)}),_N_E=e.O()}]);